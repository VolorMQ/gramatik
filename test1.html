<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Match Annoncer</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(180deg, #f4f8fb, #e9eff3);
    padding: 40px;
    color: #333;
  }

  h1 {
    text-align: center;
    color: #1a5276;
    font-size: 32px;
    margin-bottom: 30px;
  }

  #prompt {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    background: #e3f2fd;
    border: 2px solid #90caf9;
    border-radius: 10px;
    padding: 18px;
    margin: 0 auto 40px auto;
    width: 70%;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .announcement {
    background: #fff;
    margin: 20px auto;
    padding: 25px 30px;
    width: 70%;
    border-radius: 15px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .announcement:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.15);
  }

  .announcement.selected {
    border: 2px solid #2196f3;
    background: #e3f2fd;
  }

  .announcement.correct {
    border: 2px solid #2ecc71;
    background: #eafaf1;
  }

  .announcement.wrong {
    border: 2px solid #e74c3c;
    background: #fdecea;
  }

  .announcement-title {
    text-align: center;
    font-size: 22px;
    font-weight: bold;
    color: #1565c0;
    margin-bottom: 12px;
  }

  .announcement-text {
    font-size: 17px;
    line-height: 1.6;
    white-space: pre-line;
    text-align: justify;
  }

  .buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 30px;
  }

  button {
    background: #1565c0;
    color: #fff;
    border: none;
    padding: 12px 28px;
    font-size: 18px;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    background: #0d47a1;
  }

  #progress, #score {
    text-align: center;
    margin-top: 15px;
    font-size: 17px;
  }

  #score {
    font-weight: bold;
    color: #1a5276;
  }

  .fade {
    animation: fadeIn 0.6s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
</head>
<body>

<h1>Find den rigtige annonce</h1>
<div id="prompt">IndlÃ¦ser...</div>
<div id="announcements"></div>

<div class="buttons">
  <button onclick="checkAnswer()">Tjek svar</button>
  <button id="nextBtn" onclick="nextSet()" style="display:none;">NÃ¦ste opgave</button>
</div>

<div id="progress"></div>
<div id="score"></div>

<script>
let data = null;
let usedSets = [];
let selectedIndex = null;
let currentSet = null;
let score = 0;

async function loadData() {
  const response = await fetch("announcements.json");
  data = await response.json();
  nextSet(true);
}

function getRandomSet() {
  const available = data.sets.filter((_, i) => !usedSets.includes(i));
  if (available.length === 0) return null;
  const randomIndex = Math.floor(Math.random() * available.length);
  const realIndex = data.sets.indexOf(available[randomIndex]);
  usedSets.push(realIndex);
  return data.sets[realIndex];
}

function renderSet(set) {
  const promptEl = document.getElementById("prompt");
  const container = document.getElementById("announcements");
  const nextBtn = document.getElementById("nextBtn");
  const progress = document.getElementById("progress");
  const scoreEl = document.getElementById("score");

  container.classList.add("fade");
  promptEl.classList.add("fade");

  promptEl.textContent = "Emne : " + set.prompt;
  container.innerHTML = "";
  nextBtn.style.display = "none";
  selectedIndex = null;

  progress.textContent = `Opgave ${usedSets.length} af ${data.sets.length}`;
  scoreEl.textContent = `âœ… Rigtige svar: ${score} / ${data.sets.length}`;

  set.announcements.forEach((item, index) => {
    const div = document.createElement("div");
    div.className = "announcement fade";

    div.innerHTML = `
      <div class="announcement-title">${item.title}</div>
      <div class="announcement-text">${item.text}</div>
    `;

    div.onclick = () => {
      document.querySelectorAll(".announcement").forEach(a => a.classList.remove("selected"));
      div.classList.add("selected");
      selectedIndex = index;
    };

    container.appendChild(div);
  });
}

function checkAnswer() {
  if (!currentSet) return;
  if (selectedIndex === null) {
    alert("VÃ¦lg venligst en annonce!");
    return;
  }

  const announcements = document.querySelectorAll(".announcement");
  announcements.forEach((div, idx) => {
    div.classList.remove("correct","wrong");
    if (idx === currentSet.correctIndex) div.classList.add("correct");
    else if (idx === selectedIndex) div.classList.add("wrong");
  });

  if (selectedIndex === currentSet.correctIndex) {
    score++;
  }

  document.getElementById("score").textContent = `âœ… Rigtige svar: ${score} / ${data.sets.length}`;
  document.getElementById("nextBtn").style.display = "inline-block";
}

function nextSet(first = false) {
  const set = getRandomSet();
  if (!set) {
    document.getElementById("prompt").textContent = "ðŸŽ‰ Du har gennemfÃ¸rt alle opgaver!";
    document.getElementById("announcements").innerHTML = "";
    document.querySelector(".buttons").style.display = "none";
    document.getElementById("progress").textContent = "";
    document.getElementById("score").textContent = `Endeligt resultat: ${score} / ${data.sets.length}`;
    return;
  }
  currentSet = set;
  renderSet(set);
}

loadData();
</script>

</body>
</html>
